<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <script async defer src="https://buttons.github.io/buttons.js"></script>

        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Messages handling - Luos.io - Documentation</title>
        
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Luos official documentation pages">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" type="image/png" href="../../../favicon-luos.png">
        <!--<link rel="shortcut icon" type="image/png" href="../../../">-->
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../../../src/_assets/css/custom.css">
        

        

        <!-- Chat Zoho -->
        <script type="text/javascript"> 
            var $zoho=$zoho || {};
            $zoho.salesiq = $zoho.salesiq || {widgetcode:"3527438c9fcafa0972a3a2576fae38964b4fe1b8f520ccf46ff8317a97584595", values:{},ready:function(){}};
            var d=document;s=d.createElement("script");
            s.type="text/javascript";
            s.id="zsiqscript";
            s.defer=true;
            s.src="https://salesiq.zoho.eu/widget";
            t=d.getElementsByTagName("script")[0];
            t.parentNode.insertBefore(s,t);
            d.write("<div id='zsiqwidget'></div>"); </script>

        <link href="../../../_assets/css/form.css" rel="stylesheet" type="text/css">
        <script src="../../../_assets/js/validation.js"></script>
        
        <div style="position:fixed;top:calc(50% - 250px);right:0;transition:width 300ms ease-out;width:0; z-index: 99;" data-qa="side_panel"> <a class="typeform-share button" href="https://form.typeform.com/to/KqtBEb6N?typeform-medium=embed-snippet" data-mode="side_panel" style="box-sizing:border-box;position:absolute;top:300px;width:230px;height:48px;padding:0 20px;margin:0;cursor:pointer;background:#75DBC7;border-radius:4px 4px 0px 0px;box-shadow:0px 2px 12px rgba(0, 0, 0, 0.06), 0px 2px 4px rgba(0, 0, 0, 0.08);display:flex;align-items:center;justify-content:flex-start;transform:rotate(-90deg);transform-origin:bottom left;color:white;text-decoration:none;z-index:9999;" data-hide-headers="true" data-hide-footer="true" data-width="320" data-height="500" target="_blank"> <span class="icon" style="width:32px;position:relative;text-align:center;transform:rotate(90deg) scale(0.85);left:-8px;"> <img alt="" src="https://images.typeform.com/images/9agMH7QtgJsU" style="max-width:24px;max-height:24px;margin-top:10px;" /> </span> <span style="text-decoration:none;font-size:18px;font-family:Helvetica,Arial,sans-serif;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:100%;text-align:center;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;">Is Luos for me? ü§î</span> </a> </div> <script> (function() { var qs,js,q,s,d=document, gi=d.getElementById, ce=d.createElement, gt=d.getElementsByTagName, id="typef_orm_share", b="https://embed.typeform.com/"; if(!gi.call(d,id)){ js=ce.call(d,"script"); js.id=id; js.src=b+"embed.js"; q=gt.call(d,"script")[0]; q.parentNode.insertBefore(js,q) } })() </script>
    </head>
    <body>

            <!-- Provide site root to javascript -->
            <script type="text/javascript">
                var path_to_root = "../../../";
                var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
            </script>
    		
            <!-- Work around some values being stored in localStorage wrapped in quotes -->
            <script type="text/javascript">
                try {
                    var theme = localStorage.getItem('mdbook-theme');
                    var sidebar = localStorage.getItem('mdbook-sidebar');

                    if (theme.startsWith('"') && theme.endsWith('"')) {
                        localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                    }

                    if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                        localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                    }
                } catch (e) { }
            </script>

            <!-- Set the theme before any content is loaded, prevents flash -->
            <script type="text/javascript">
                var theme;
                try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
                if (theme === null || theme === undefined) { theme = default_theme; }
                var html = document.querySelector('html');
                html.classList.remove('no-js')
                html.classList.remove('light')
                html.classList.add(theme);
                html.classList.add('js');
            </script>

            <!-- Hide / unhide sidebar before it is displayed -->
            <script type="text/javascript">
                var html = document.querySelector('html');
                var sidebar = 'hidden';
                if (document.body.clientWidth >= 1080) {
                    try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                    sidebar = sidebar || 'visible';
                }
                html.classList.remove('sidebar-visible');
                html.classList.add("sidebar-" + sidebar);
            </script>

    		<nav id="sidebar" class="sidebar" aria-label="Table of contents">
    			<div id="sidebar-scrollbox" class="sidebar-scrollbox" style="padding-top: 100px;">
    				<ol class="chapter"><li class="chapter-item affix "><a href="../../../index.html">Home</a></li><li class="chapter-item "><a href="../../../pages/overview/general-basics.html"><strong aria-hidden="true">1.</strong> Basics</a></li><li class="chapter-item expanded "><a href="../../../pages/low/low-level.html"><strong aria-hidden="true">2.</strong> Low level</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../pages/low/dev-env.html"><strong aria-hidden="true">2.1.</strong> Development environment</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../pages/low/dev_env/general-integration-consideration.html"><strong aria-hidden="true">2.1.1.</strong> General integration</a></li><li class="chapter-item "><a href="../../../pages/low/dev_env/platformio.html"><strong aria-hidden="true">2.1.2.</strong> PlatformIO</a></li><li class="chapter-item "><a href="../../../pages/low/dev_env/arduino.html"><strong aria-hidden="true">2.1.3.</strong> Arduino</a></li></ol></li><li class="chapter-item "><a href="../../../pages/low/hardware-topics.html"><strong aria-hidden="true">2.2.</strong> Hardware Topics</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../pages/low/hardware_topics/minimal-requirements.html"><strong aria-hidden="true">2.2.1.</strong> Minimum Requirements</a></li><li class="chapter-item "><a href="../../../pages/low/hardware_topics/electronic-design.html"><strong aria-hidden="true">2.2.2.</strong> Electronic design</a></li><li class="chapter-item "><a href="../../../pages/low/hardware_topics/luos-hal.html"><strong aria-hidden="true">2.2.3.</strong> Use of Luos HAL</a></li></ol></li><li class="chapter-item expanded "><a href="../../../pages/low/containers.html"><strong aria-hidden="true">2.3.</strong> Containers</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../pages/low/containers/create-project.html"><strong aria-hidden="true">2.3.1.</strong> Create Luos projects</a></li><li class="chapter-item "><a href="../../../pages/low/containers/create-containers.html"><strong aria-hidden="true">2.3.2.</strong> Create Luos containers</a></li><li class="chapter-item "><a href="../../../pages/low/containers/od.html"><strong aria-hidden="true">2.3.3.</strong> Object dictionary</a></li><li class="chapter-item "><a href="../../../pages/low/containers/routing-table.html"><strong aria-hidden="true">2.3.4.</strong> Routing table</a></li><li class="chapter-item expanded "><a href="../../../pages/low/containers/msg-handling.html" class="active"><strong aria-hidden="true">2.3.5.</strong> Messages handling</a></li><li class="chapter-item "><a href="../../../pages/low/containers/self-healing.html"><strong aria-hidden="true">2.3.6.</strong> Self-healing</a></li><li class="chapter-item "><a href="../../../pages/low/containers/streaming.html"><strong aria-hidden="true">2.3.7.</strong> Streaming</a></li><li class="chapter-item "><a href="../../../pages/low/containers/rt-config.html"><strong aria-hidden="true">2.3.8.</strong> Real-time configuration</a></li><li class="chapter-item "><a href="../../../pages/low/containers/examples.html"><strong aria-hidden="true">2.3.9.</strong> Codes Examples</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../pages/high/high-level.html"><strong aria-hidden="true">3.</strong> High level</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../pages/high/json-api.html"><strong aria-hidden="true">3.1.</strong> JSON API</a></li><li class="chapter-item "><a href="../../../pages/high/pyluos.html"><strong aria-hidden="true">3.2.</strong> Pyluos</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../pages/high/containers_list/angle.html"><strong aria-hidden="true">3.2.1.</strong> Angle</a></li><li class="chapter-item "><a href="../../../pages/high/containers_list/color.html"><strong aria-hidden="true">3.2.2.</strong> Color</a></li><li class="chapter-item "><a href="../../../pages/high/containers_list/controller-motor.html"><strong aria-hidden="true">3.2.3.</strong> Controller motor</a></li><li class="chapter-item "><a href="../../../pages/high/containers_list/dc-motor.html"><strong aria-hidden="true">3.2.4.</strong> DC motor</a></li><li class="chapter-item "><a href="../../../pages/high/containers_list/distance.html"><strong aria-hidden="true">3.2.5.</strong> Distance</a></li><li class="chapter-item "><a href="../../../pages/high/containers_list/dxl.html"><strong aria-hidden="true">3.2.6.</strong> Dynamixel motor</a></li><li class="chapter-item "><a href="../../../pages/high/containers_list/gate.html"><strong aria-hidden="true">3.2.7.</strong> Gate</a></li><li class="chapter-item "><a href="../../../pages/high/containers_list/imu.html"><strong aria-hidden="true">3.2.8.</strong> IMU</a></li><li class="chapter-item "><a href="../../../pages/high/containers_list/light.html"><strong aria-hidden="true">3.2.9.</strong> Light</a></li><li class="chapter-item "><a href="../../../pages/high/containers_list/servo.html"><strong aria-hidden="true">3.2.10.</strong> Servo motor</a></li><li class="chapter-item "><a href="../../../pages/high/containers_list/state.html"><strong aria-hidden="true">3.2.11.</strong> State</a></li><li class="chapter-item "><a href="../../../pages/high/containers_list/stepper.html"><strong aria-hidden="true">3.2.12.</strong> Stepper motor</a></li><li class="chapter-item "><a href="../../../pages/high/containers_list/voltage.html"><strong aria-hidden="true">3.2.13.</strong> Voltage</a></li></ol></li><li class="chapter-item "><a href="../../../pages/high/ros.html"><strong aria-hidden="true">3.3.</strong> ROS</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../pages/high/ros/bike_alarm.html"><strong aria-hidden="true">3.3.1.</strong> ROS package example</a></li><li class="chapter-item "><a href="../../../pages/high/ros/ros1.html"><strong aria-hidden="true">3.3.2.</strong> Retrocompatibility with ROS 1</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../pages/demo_boards/demo-boards.html"><strong aria-hidden="true">4.</strong> Demonstration boards examples</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../pages/demo_boards/electronic-use.html"><strong aria-hidden="true">4.1.</strong> Boards general use</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/quick-start.html"><strong aria-hidden="true">4.2.</strong> Quick start</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards-list.html"><strong aria-hidden="true">4.3.</strong> Boards list</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/battery-power-input.html"><strong aria-hidden="true">4.3.1.</strong> Battery power input</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/button.html"><strong aria-hidden="true">4.3.2.</strong> Button</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/controller-motor.html"><strong aria-hidden="true">4.3.3.</strong> Controller motor</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/dc-motor.html"><strong aria-hidden="true">4.3.4.</strong> DC motor</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/distance.html"><strong aria-hidden="true">4.3.5.</strong> Distance sensor</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/dxl.html"><strong aria-hidden="true">4.3.6.</strong> Dynamixel motor</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/gpio.html"><strong aria-hidden="true">4.3.7.</strong> GPIO</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/imu.html"><strong aria-hidden="true">4.3.8.</strong> IMU</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/jack-power-input.html"><strong aria-hidden="true">4.3.9.</strong> Jack power input</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/light.html"><strong aria-hidden="true">4.3.10.</strong> Light sensor</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/led-strip.html"><strong aria-hidden="true">4.3.11.</strong> LED strip</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/potentiometer.html"><strong aria-hidden="true">4.3.12.</strong> Potentiometer</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/power-isolator.html"><strong aria-hidden="true">4.3.13.</strong> Power isolator</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/powerpi.html"><strong aria-hidden="true">4.3.14.</strong> Power Pi</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/powerswitch.html"><strong aria-hidden="true">4.3.15.</strong> Power switch</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/rgbled.html"><strong aria-hidden="true">4.3.16.</strong> RGB LED</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/servo.html"><strong aria-hidden="true">4.3.17.</strong> Servo motor</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/stepper.html"><strong aria-hidden="true">4.3.18.</strong> Stepper motor</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/usb.html"><strong aria-hidden="true">4.3.19.</strong> USB</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/wifible.html"><strong aria-hidden="true">4.3.20.</strong> Wifi BLE</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/wire-power-input.html"><strong aria-hidden="true">4.3.21.</strong> Wire power input</a></li><li class="chapter-item "><a href="../../../pages/demo_boards/boards_list/cables.html"><strong aria-hidden="true">4.3.22.</strong> Cables</a></li></ol></li></ol></li></ol>
    			<p style="marging-bottom: 40px;"><a class="cust_menu_item" href="https://www.luos.io" target="_blank">Go to Luos.io &#8599;</a></p>
               
                </div>


                <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
            </nav>

            <script src="https://kit.fontawesome.com/e122236495.js" crossorigin="anonymous"></script>

            <div class="cust_menu_container">

                <div class="cust_column cust_logo_container">
                    <a href="https://docs.luos.io/"><img src="../../../_assets/img/logo_luos_animated_white.gif" alt="Luos" id="logo" width="72px"></a>
                </div>

                <div class="cust_column cust_middle">

                    <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar"><i class="fa fa-bars"></i>
                    </button>
                    <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                        <i class="fa fa-paint-brush"></i>
                    </button>
                    <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                        <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                    </ul>
                    
                    <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                        <i class="fa fa-search"></i>
                    </button>
                    
                    <a href="../../../print.html" title="Print this documentation" aria-label="Print this book"><i id="print-button" class="fa fa-print" style="padding-left: 5px;transform: translate(0px,1px) scale(0.8);"></i></a>

                </div>
                <div class="cust_column cust_right">

                    <a title="" target="_blank" href="https://www.luos.io/#technology">Technology</a>
                    <a title="" target="_blank" href="https://www.luos.io/pricing">Pricing</a>
                    <a title="" target="_blank" href="https://www.luos.io/appstore">Appstore</a>
                    <a title="" target="_blank" href="https://www.luos.io/blog">Blog</a>
                    <a style="color: #bd99ff;">Docs</a>
                    <a title="Download on Github" target="_blank" rel="noopener noreferrer" href="https://github.com/luos-io">Download</a>                    
                    

                </div>
            </div>

            <div id="page-wrapper" class="page-wrapper">

                <div class="page">
                    

                    
                    <div id="search-wrapper" class="hidden">
                        <form id="searchbar-outer" class="searchbar-outer">
                            <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                        </form>
                        <div id="searchresults-outer" class="searchresults-outer hidden">
                            <div id="searchresults-header" class="searchresults-header"></div>
                            <ul id="searchresults">
                            </ul>
                        </div>
                    </div>
                    

                    <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                    <script type="text/javascript">
                        document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                        document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                        Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                            link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                        });
                    </script>

                    <div id="content" class="content">
                        <main>
                            <h1 id="containers-communication-handling-messages"><a class="header" href="#containers-communication-handling-messages">Containers communication handling messages</a></h1>
<blockquote>
<p><strong>Warning:</strong> Make sure to read and understand how to <a href="./create-project.html">Create Luos containers</a> before reading this page.</p>
</blockquote>
<p>As a developer, you will have to create and use Luos messages to exchange information between <span class="cust_tooltip">containers<span class="cust_tooltiptext">Software element run by Luos that can communicate with other containers. It can be a driver or an app. (Initially called a module)</span></span>. In order to do that, you have to understand how messages work.</p>
<h2 id="message-structure"><a class="header" href="#message-structure">Message structure</a></h2>
<p>Luos messages are managed by the <code>msg_t</code> structure:</p>
<pre><code class="language-C">typedef struct{
    header_t header;
    uint8_t data[MAX_DATA_MSG_SIZE];
}msg_t;
</code></pre>
<p>All messages have a header. A header is a 7-byte field containing all information allowing containers to understand messages context. All containers on the network catch and decode the header of each sent and received message.</p>
<p><code>data</code> is a table containing data.</p>
<blockquote>
<p><strong>Info:</strong> MAX_DATA_MSG_SIZE represenst the maximum size of messages (default value is 128 bytes);</p>
</blockquote>
<h2 id="header"><a class="header" href="#header">Header</a></h2>
<p>To send data to any containers you want, you will have to first fill out some information on the header.</p>
<p>here is the <code>header_t</code> structure:</p>
<pre><code class="language-C">typedef struct{
    uint16_t protocol : 4;    /*!&lt; Protocol version. */
    uint16_t target : 12;     /*!&lt; Target address, it can be (ID, Multicast/Broadcast, Type). */
    uint16_t target_mode : 4; /*!&lt; Select targeting mode (ID, ID+ACK, Multicast/Broadcast, Type). */
    uint16_t source : 12;     /*!&lt; Source address, it can be (ID, Multicast/Broadcast, Type). */
    uint8_t cmd;              /*!&lt; msg definition. */
    uint16_t size;            /*!&lt; Size of the data field. */
}header_t;
</code></pre>
<ul>
<li><strong>Protocol (4 bits)</strong>: This field provides the protocol revision. This field is automatically filled, you don't have to deal with it.</li>
<li><strong>Target (12 bits)</strong>: This field contains the target address. Make sure to understand the real destination of this field, you have to know the addressing mode contained on the <em>Target_mode</em> field.</li>
<li><strong>Target_mode (4 bits)</strong>: This field indicates the addressing mode and how to understand the <em>Target</em> field. It can take different values:
<ul>
<li><strong>ID</strong>: This mode allows to communicate with a unique container using its ID <strong>without</strong> acknowledgment return.</li>
<li><strong>ID_ACK</strong>: This mode allows to communicate with a unique container using its ID <strong>with</strong> acknowledgment return.</li>
<li><strong>Multicast/Broadcast</strong>: This mode allows multiple containers to catch a message. In this case, the message contains a type of data used by multiple containers.</li>
<li><strong>Type</strong>: This mode sends a message to all containers with a given type, for example all &quot;Sharp digital distance sensor&quot;.</li>
</ul>
</li>
<li><strong>Source (12 bits)</strong>: The unique ID of the transmitter container.</li>
<li><strong>CMD (8 bits)</strong>: The command defines the transmitted data's type.</li>
<li><strong>Size (16 bits)</strong>: Size of the incoming data.</li>
</ul>
<h1 id="receive-and-send-a-basic-message"><a class="header" href="#receive-and-send-a-basic-message">Receive and send a basic message</a></h1>
<p>To send a message you have to:</p>
<ol>
<li>Create a message variable</li>
<li>Set the <strong>target_mode</strong></li>
<li>Set the <strong>target</strong></li>
<li>Set the <strong>cmd</strong></li>
<li>Set your data <strong>size</strong></li>
<li>Set your data</li>
<li>Send it.</li>
</ol>
<p>Below is a basic reply example that you can find in a container reception callback. For more information on handling a message received, see <a href="./rt-config.html">Real-time configuration</a> page.</p>
<pre><code class="language-c">void containers_MsgHandler(container_t *container, msg_t *msg) {
    if (msg-&gt;header.cmd == ASK_PUB_CMD) {
        // fill the message info
        msg_t pub_msg;
        pub_msg.header.target_mode = ID;
        pub_msg.header.target = msg-&gt;header.source;
        pub_msg.header.cmd = IO_STATE;
        pub_msg.header.size = sizeof(char);
        pub_msg.data[0] = 0x01;
        Luos_SendMsg(container, &amp;pub_msg);
        return;
    }
}
</code></pre>
<blockquote>
<p><strong>Note:</strong> the function <em>Luos_SendMsg</em> return an error_status that informw user if the message was stored in buffer and is ready to be sent. User can monitor the return value and make a blocking statement to be sure that the message is ready to be sent.</p>
</blockquote>
<pre><code class="language-c">while(Luos_SendMsg(container, &amp;pub_msg) ! SUCCEED);
</code></pre>
<h2 id="container-exclusion"><a class="header" href="#container-exclusion">Container exclusion</a></h2>
<p>Luos includes an acknowledgement management using the <strong>ID_ACK</strong> target_mode. This mode guaranties the proper reception of critical messages.</p>
<p>If Luos fails to reach its target using ID_ACK, it will retry, sending up to 10 times. If the acknowledgement still fails, the targeted container is declared excluded. Excluded containers are removed from the routing table to avoid any messaging by any containers, preserving bandwidth for the rest of the system.</p>
<h2 id="large-data"><a class="header" href="#large-data">Large data</a></h2>
<p>You will sometimes have to deal with large data that could be larger than the maximum 128-byte data on a Luos message. Fortunately, Luos is able to automatically fragment and de-fragment the data above this side. To do that, you will have to use another send function that will take care of setting the messages' size, and the data fields.</p>
<p>For example, here is how to send a picture:</p>
<pre><code class="language-c">// fill the large message info
msg_t msg;
color_t picture[300*300] = {/*Your favorite cat picture data*/};
msg.header.target_mode = ID_ACK;
msg.header.target = 12;
msg.header.cmd = COLOR;
Luos_SendData(container, &amp;msg, picture, sizeof(color_t)*300*300);
return;
</code></pre>
<p>In the reception callback, here is the code for retrieve the message with the receiving container (the one with ID 12):</p>
<pre><code class="language-c">color_t picture[300*300];
void containers_MsgHandler(container_t *container, msg_t *msg) {
    if (msg-&gt;header.cmd == COLOR) {
        Luos_ReceiveData(container, msg, (void*)picture);
    }
}
</code></pre>
<blockquote>
<p><strong>Note:</strong> If you have to deal with high-frequency real-time data, please read <a href="./streaming.html">the Streaming page</a>.</p>
</blockquote>
<h2 id="time-triggered-update-messages"><a class="header" href="#time-triggered-update-messages">Time-triggered update messages</a></h2>
<p>Luos provides a standard command to ask a container to retrieve values from a sensor, called <code>ASK_PUB_CMD</code>. However, sometimes apps need to poll values from sensors, but the act of repeatedly retriving a value using the <code>ASK_PUB_CMD</code> command may result in the use of a lot bandwidth and take up valuable resources.
In this kind of polling situation, <strong>you can use the time-triggered auto-update features available from any Luos container</strong>. This feature allows you to ask a container to send you an update of any value each X milliseconds.
To use it, you have to setup targeted container with a message containing a standard time <span class="cust_tooltip">object dictionary<span class="cust_tooltiptext">Set of objects based on SI metric system that can be transmitted through Luos messages. Any object can easily be converted in other units.</span></span>, but with a specific command associated to it.</p>
<p>For example, to update a container each 10 ms:</p>
<pre><code class="language-C">time_luos_t time = TimeOD_TimeFrom_ms(10);
msg_t msg;
msg.header.target = id;
msg.header.target_mode = IDACK;
TimeOD_TimeToMsg(&amp;time, &amp;msg);
msg.header.cmd = UPDATE_PUB;
Luos_SendMsg(app, &amp;msg);
</code></pre>
<blockquote>
<p><strong>Info:</strong> containers can handle only one time-triggered target, 2 containers of the same network can't ask a time-triggered value from the same container.</p>
</blockquote>
<blockquote>
<p><strong>Warning:</strong> To prevent any ID movement, auto-update configuration is reset on all containers on each detection (see <a href="./routing-table.html">Routing table page</a> for more information).</p>
</blockquote>


                            <div class="cust_edit_page"><a id="gh_link">Contribute to this page</a>&nbsp;|&nbsp;<a id="feedback" class="cust_red_link" onclick="openFeedback()">This page wasn't helpful? &#128078;</a></div><div align="right" style="float: right; height: 30px; width: 400px; position: relative; top: -18px;"><a class="github-button" href="https://github.com/Luos-io" data-show-count="true" aria-label="Follow @Luos-io on GitHub">Follow @Luos-io</a>&nbsp;<a class="github-button" href="https://github.com/Luos-io/Luos/subscription" data-icon="octicon-eye" data-show-count="true" aria-label="Watch Luos-io/Luos on GitHub">Watch</a>&nbsp;<a class="github-button" href="https://github.com/Luos-io/Luos" data-icon="octicon-star" data-show-count="true" aria-label="Star Luos-io/Luos on GitHub">Star</a></div>

                            
                            <script language="javascript">
                                // Contribute to this page's href address
                                var page = window.location.pathname.slice(0, -4)+'md';
                                document.getElementById('gh_link').href = 'https://github.com/Luos-io/doc/tree/master/src'+page;
                                
                            </script>


                            <script language="javascript">
                                // Open the new window for feedback page
                                function openFeedback() {
                                  var myWindow = window.open("", "MsgWindow", "toolbar=yes,scrollbars=no,resizable=no,width=550,height=280");
                                  myWindow.document.write("<!DOCTYPE HTML><html><head><title>Luos documentation feedback</title><style>body{font-family: 'Roboto', sans-serif;} .zf-fmFooter .zf-submitColor{ font-size:14px; padding:4px 10px;}.zf-submitColor{ color: #fff; border:1px solid; border-color: #2F9EEC #1988D6 1988D6; background: #2596e6; background: -webkit-gradient(linear, left top, left bottom, from(#2f9eec), to(#1988d6)); background: moz-linear-gradienttop,  #2f9eec,  #1988d6); filter:  progid:DXImageTransform.Microsoft.gradient(startColorstr='#2f9eec', endColorstr='#1988d6'); moz-box-shadow:0 1px 2px rgba(0, 0, 0, 0.15); -webkit-box-shadow:0 1px 2px rgba(0, 0, 0, 0.15); box-shadow:0 1px 2px rgba(0, 0, 0, 0.15); text-shadow:0 1px 0 rgba(0, 0, 0, 0.25);  } .zf-submitColor:hover{ background: #1988d6; background: -webkit-gradient(linear, left top, left bottom, from(#1988d6), to(#1988d6)); background: -moz-linear-gradient(top,  #1988d6,  #1988d6);   filter:  progid:DXImageTransform.Microsoft.gradient(startColorstr='#1988d6', endColorstr='#1988d6'); }textarea#details_feedback{  width: 90%;  height: 100px;  padding: 12px 12px;  margin: 8px 0;  display: inline-block;  border: 1px solid #ccc;  border-radius: 4px;  box-sizing: border-box;}</style></head><body><div style=\"margin: 20px 0 20px 0; padding: 10px 20px 20px 20px; width: 90%; background-color: #efefef;\" id=\"feedback-block\"><form action=\'https://forms.zohopublic.eu/luosio/form/Thumbsurvey/formperma/BlTjwTQeX5v3FQDKFEHW5NNUgyllNOKxC-9a5miMlSw/htmlRecords/submit\' name=\'form\' method=\'POST\' onSubmit=\'javascript:document.charset=\"UTF-8\"; return zf_ValidateAndSubmit();\' accept-charset=\'UTF-8\' enctype=\'multipart/form-data\' id=\'form\'><input type=\"hidden\" name=\"zf_referrer_name\" value=\"\"><input type=\"hidden\" name=\"zf_redirect_url\" value=\"\"><input type=\"hidden\" name=\"zc_gad\" value=\"\"><div style=\"margin: 5px 5px 5px 0px; color: #333; font-size: 1.5em;\">Help us to improve our documentation.<\/div><div style=\"margin: 0 0 0 10px; padding: 0 0 0 15px; border-left: 2px solid #ccc\"<label style=\"color: #909090; font-size: 0.9em; font-style: italic;\">Add details to help us improve this page: <\/label><div><textarea id=\"details_feedback\" name=\"MultiLine\" checktype=\"c1\" maxlength=\"65535\"><\/textarea><p id=\"MultiLine_error\" style=\"display:none;\">Invalid value<\/p><\/div><label style=\"display:none;\">window.location.href <\/label><div style=\"display:none;\"><textarea id=\"pageLocation\" name=\"MultiLine1\" checktype=\"c1\" maxlength=\"65535\"><\/textarea><p id=\"MultiLine1_error\" class=\"zf-errorMessage\" style=\"display:none;\">Invalid value<\/p><\/div><button class=\"zf-submitColor\" style=\"margin-top: 12px;\">Submit<\/button><\/div><\/form><\/div><script type=\"text/javascript\">var zf_DateRegex = new RegExp(\"^(([0][1-9])|([1-2][0-9])|([3][0-1]))[-](Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec|JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[-](?:(?:19|20)[0-9]{2})$\"); var zf_MandArray = []; var zf_FieldArray = [ \"MultiLine\", \"MultiLine1\"];var isSalesIQIntegrationEnabled = false; var salesIQFieldsArray = []; document.getElementById(\'pageLocation\').value = window.location.href;<\/script></body>");
                                }
                            </script>


                            <br />

                                <!-- newsletter subscription -->
                                <iframe frameborder="0" style="height:200px;width:99%;border:none;" src='https://luos.maillist-manage.eu/ua/Optin?od=12ba7e1d8761&zx=14ac451cc1&lD=1b0211bfd6a6409&n=11699f74e8efc17&sD=1b0211bfd6dd285'></iframe>


                            <br />

                            <div class="cust_footer">
                                <p align="center">¬©2018-2020 <a href="https://www.luos.io">Luos.io</a></p>
                            </div>

                        </main>

                        <nav class="nav-wrapper" aria-label="Page navigation">
                            <!-- Mobile navigation buttons -->
                            
                                <a rel="prev" href="../../../pages/low/containers/routing-table.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                    <i class="fa fa-angle-left"></i>
                                </a>
                            

                            
                                <a rel="next" href="../../../pages/low/containers/self-healing.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                    <i class="fa fa-angle-right"></i>
                                </a>
                            

                            <div style="clear: both"></div>
                        </nav>
                    </div>
                </div>

                <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    
                        <a rel="prev" href="../../../pages/low/containers/routing-table.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                            <i class="fa fa-angle-left"></i>
                        </a>
                    

                    
                        <a rel="next" href="../../../pages/low/containers/self-healing.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                            <i class="fa fa-angle-right"></i>
                        </a>
                    
                </nav>

            </div>

            

            
            <!-- Google Analytics Tag -->
            <script type="text/javascript">
                var localAddrs = ["localhost", "127.0.0.1", ""];

                // make sure we don't activate google analytics if the developer is
                // inspecting the book locally...
                if (localAddrs.indexOf(document.location.hostname) === -1) {
                    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

                    ga('create', 'UA-153509818-3', 'auto');
                    ga('send', 'pageview');
                }
            </script>
            

            
            
            

            

            
            <script src="../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
            <script src="../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
            <script src="../../../searcher.js" type="text/javascript" charset="utf-8"></script>
            

            <script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
            <script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
            <script src="../../../book.js" type="text/javascript" charset="utf-8"></script>

            <!-- Custom JS scripts -->
            

            


    </body>
    <script type="text/javascript">
        _linkedin_partner_id = "3400409";
        window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
        window._linkedin_data_partner_ids.push(_linkedin_partner_id);
    </script><script type="text/javascript">
        (function(){var s = document.getElementsByTagName("script")[0];
        var b = document.createElement("script");
        b.type = "text/javascript";b.async = true;
        b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
        s.parentNode.insertBefore(b, s);})();
    </script>
    <noscript>
        <img height="1" width="1" style="display:none;" alt="" src="https://px.ads.linkedin.com/collect/?pid=3400409&fmt=gif" />
    </noscript>
</html>
